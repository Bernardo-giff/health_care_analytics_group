---
title: "EDA"
output: html_document
date: "2024-07-07"
---

This first chunk installs necessary packages.
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
install.packages("haven")
```

```{r}
library(haven)
library(tidyr)
library(ggplot2)
library(dplyr)
library(stargazer)
library(stringr)
library(naniar)
```

```{r}
# Change this if you saves the file in a different path
file = "gss_spss_with_codebook/GSS7218_R3.sav"

# Read the data file
raw_data <- read_sav(file)
```

By inspecting the codebook, we selected the following variables to take a closed look at (i.e: Our control variables)

```{r}
# Selecting candidate variables

sliced_data <- raw_data %>%
  select(
    # First, start with Mental health related variables
    # These are the Health variables
    SNSMOTH1   # DO YOU USE ANY OTHER SOCIAL NETWORKS
    , SNSMOT2A #  FIRST OTHER SOCIAL NETWORK
    , SNSMOT2B #  SECOND OTHER SOCIAL NETWORK
    , SNSMOT2C #  THIRD OTHER SOCIAL NETWORK
    , SNSMNEW  # WHICH SOCIAL NETWORK DID YOU JOIN MOST RECENTLY
    , SNSMYEAR #  YEAR FIRST JOINED SNS
    , SNSMFRST #  WHICH SOCIAL NETWORK DID YOU JOIN FIRST
    , INTWKDYM #  MINUTES OF INTERNET USE ON WEEKDAYS
    , INTWKDYH #  HOURS OF INTERNET USE ON WEEKDAYS
    , INTWKENM #  MINUTES OF INTERNET USE ON WEEKENDS
    , INTWKENH #  HOURS OF INTERNET USE ON WEEKENDS
    , NUMPROBS #  HOW MANY FRIENDS CLOSE TO DISCUSS PROBLEMS
    , BYEMPROB #  HOW MANY FRIENDS DISCUSS PROBLEMS VIA EMAIL
    , INTACCSS #  DOES R HAVE INTERNET THROUGH CELL PHONE OR PDA
    , MNTLHLTH #  DAYS OF POOR MENTAL HEALTH PAST 30 DAYS
    # Then, control variables
    , YEAR     # GSS YEAR FOR THIS RESPONDENT
      # Labour
    , ID       # RESPONDENT ID NUMBER
    , WRKSTAT  # LABOR FORCE STATUS
    , HRS1     # NUMBER OF HOURS WORKED LAST WEEK
    , HRS2     # NUMBER OF HOURS USUALLY WORK A WEEK
    , COMMUTE  # TRAVEL TIME TO WORK
    , 
    , # Social
    , SEX     # RESPONDENTS SEX
    , RACE    # RACE OF RESPONDENT
    , BORN    # WAS R BORN IN THIS COUNTRY
    , REGION   # REGION OF INTERVIEW
    , INCOME06 # TOTAL FAMILY INCOME
    , RINCOM06 # RESPONDENTS INCOME
    , INCOME16 # TOTAL FAMILY INCOME
    , RINCOM16 # RESPONDENTS INCOME
  )

```

Since we are interested in the impact of social media usage on people's metal health (perceived), we will limit the scope of the data to the responses from 2006 and 2016

```{r}

# Plot bar plot for 'Exercise' variable
ggplot(raw_data, aes(x = YEAR)) +
  geom_bar() +
  labs(title = "Number of reponses by year", x = "Year", y = "Count") +
  theme_minimal()

```
We see that it has a similar level of responses to the other years so there are no concerns with regards to the availability of the data.

```{r}
filtered_data <- sliced_data %>%
  filter(YEAR %in% c(2006, 2016))
```

Next let's check for missing variables

```{r}
vis_miss(filtered_data)
```

We assume the variables where 100% of the data is missing to be not present in the latest version of the survey. Therefore we remove them from the target variables:

```{r}
sliced_data <- filtered_data %>%
  select(
    # First, start with Mental health related variables
    # These are the Health variables
    SNSMOTH1   # DO YOU USE ANY OTHER SOCIAL NETWORKS
    , SNSMOT2A #  FIRST OTHER SOCIAL NETWORK
    , SNSMNEW  # WHICH SOCIAL NETWORK DID YOU JOIN MOST RECENTLY
    , SNSMYEAR #  YEAR FIRST JOINED SNS
    , SNSMFRST #  WHICH SOCIAL NETWORK DID YOU JOIN FIRST
    , INTWKDYM #  MINUTES OF INTERNET USE ON WEEKDAYS
    , INTWKDYH #  HOURS OF INTERNET USE ON WEEKDAYS
    , INTWKENM #  MINUTES OF INTERNET USE ON WEEKENDS
    , INTWKENH #  HOURS OF INTERNET USE ON WEEKENDS
    , MNTLHLTH #  DAYS OF POOR MENTAL HEALTH PAST 30 DAYS
    # Then, control variables
    , YEAR     # GSS YEAR FOR THIS RESPONDENT
      # Labour
    , ID       # RESPONDENT ID NUMBER
    , WRKSTAT  # LABOR FORCE STATUS
    , HRS1     # NUMBER OF HOURS WORKED LAST WEEK
    , HRS2     # NUMBER OF HOURS USUALLY WORK A WEEK
    , 
    , # Social
    , SEX     # RESPONDENTS SEX
    , RACE    # RACE OF RESPONDENT
    , BORN    # WAS R BORN IN THIS COUNTRY
    , REGION   # REGION OF INTERVIEW
    , INCOME06 # TOTAL FAMILY INCOME
    , RINCOM06 # RESPONDENTS INCOME
    , INCOME16 # TOTAL FAMILY INCOME
    , RINCOM16 # RESPONDENTS INCOME
  )
```

```{r}
vis_miss(sliced_data)
```

